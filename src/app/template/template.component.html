<div class="row">
  <input matInput [(ngModel)]="template['__idea']" placeholder="Idea" style="width: 100%" />
</div>

<div class="row">
  <div>
    <input placeholder="new Dataset" [(ngModel)]="newDataset" style="width: 150px; text-align: center;"
      (keyup.enter)="addToList(template['datasets'], newDataset); newDataset=''">
    <button (click)="addToList(template['datasets'], newDataset)">
      <mat-icon> add </mat-icon>
    </button>
  </div>
  <div *ngFor="let dataset of template.datasets">
    <input [(ngModel)]="dataset" style="width: 150px; text-align: center;" />
    <button (click)="removeFromList(template.datasets, dataset)">
      <mat-icon> cancel </mat-icon>
    </button>
  </div>
</div>

<div class="row">
  <div>
    <input placeholder="new Tag" [(ngModel)]="newTag" style="width: 150px; text-align: center;"
      (keyup.enter)="addToList(template['tags'], newTag); newTag=''">
    <button (click)="addToList(template.tags, newTag)">
      <mat-icon> add </mat-icon>
    </button>
  </div>
  <div *ngFor="let tag of template.tags">
    <input [(ngModel)]="tag" style="width: 150px; text-align: center;" />
    <button (click)="removeFromList(template.tags, tag)">
      <mat-icon> cancel </mat-icon>
    </button>
  </div>
</div>

<div class="row">
  <input style="width: 15%; text-align: center;" placeholder="new key" [(ngModel)]="newValueKey" />
  <input placeholder="new query" [(ngModel)]="newValueQuery" style="width: 80%"
    (keyup.enter)="addToObject(template.values, newValueKey, newValueQuery); newValueKey=''; newValueQuery='';" />
  <div style="width: 5%;">
    <button (click)="addToObject(template.values, newValueKey, newValueQuery); newValueKey=''; newValueQuery='';">
      <mat-icon> add </mat-icon>
    </button>
  </div>
</div>

<div class="row" *ngFor="let item of template.values | keyvalue: sortNull">
  <input [(ngModel)]="item.key" style="width: 15%; text-align: center;" />
  <input [(ngModel)]="item.value" style="width: 80%" (keyup.enter)="removeFromObject(template.values, item.key)" />
  <div style="width: 5%;">
    <button (click)="removeFromObject(template.values, item.key)">
      <mat-icon> cancel </mat-icon>
    </button>
  </div>
</div>

<div class="row">
  <div class="col-11">
    <div class="row">
      <div style="width: 25%; padding-right: 5%;">
        <span> Type: </span>
        <select [(ngModel)]="newField.type">
          <option *ngFor="let type of ['choose', 'write', 'bool', 'select']" [value]="'&&' + type"
            style="text-align: center;">{{type}}</option>
        </select>
      </div>

      <div style="width: 25%; padding-right: 5%;">
        <span>Section:</span>
        <select style="text-align: center;" [(ngModel)]="newField.section">
          <option *ngFor="let section of ['title', 'subtitle', 'choice', 'answer']" [value]="section">{{section}}
          </option>
        </select>
      </div>

      <div style="width: 25%; padding-right: 5%;">
        <span>Format:</span>
        <select style="text-align: center;" [(ngModel)]="newField.format">
          <option *ngFor="let format of ['text', 'photo', 'video', 'audio']" [value]="format">{{format}}</option>
        </select>
      </div>

      <div style="width: 25%; padding-right: 5%;">
        <span>Language:</span>
        <select style="text-align: center;" [(ngModel)]="newField.language">
          <option *ngFor="let language of ['persian', 'english']" [value]="language">{{language}}</option>
        </select>
      </div>

    </div>
    <div class="row">
      <input placeholder="content" [(ngModel)]="newField.content" style="width: 100%; text-align: center"
        (keyup.enter)="addFieldToTemplate(newField)" />
    </div>
  </div>
  <div class="col-1">
    <button (click)="addFieldToTemplate(newField)" class="w-100 h-100">
      <mat-icon> add </mat-icon>
    </button>
  </div>
</div>

<div class="row" *ngFor="let field of fields">
  <div class="col-11">
    <div class="row">
      <div style="width: 25%; padding-right: 5%;">
        <span> Type: </span>
        <select [(ngModel)]="field.type">
          <option *ngFor="let type of ['choose', 'write', 'bool', 'select']" [value]="'&&' + type"
            style="text-align: center;">{{type}}</option>
        </select>
      </div>

      <div style="width: 25%; padding-right: 5%;">
        <span>Section:</span>
        <select style="text-align: center;" [(ngModel)]="field.section">
          <option *ngFor="let section of ['title', 'subtitle', 'choice', 'answer']" [value]="section">{{section}}
          </option>
        </select>
      </div>

      <div style="width: 25%; padding-right: 5%;">
        <span>Format:</span>
        <select style="text-align: center;" [(ngModel)]="field.format">
          <option *ngFor="let format of ['text', 'photo', 'video', 'audio']" [value]="format">{{format}}</option>
        </select>
      </div>

      <div style="width: 25%; padding-right: 5%;">
        <span>Language:</span>
        <select style="text-align: center;" [(ngModel)]="field.language">
          <option *ngFor="let language of ['persian', 'english']" [value]="language">{{language}}</option>
        </select>
      </div>

    </div>
    <div class="row">
      <input placeholder="content" [(ngModel)]="field.content" style="width: 100%;" dir="auto" />
    </div>
  </div>
  <div class="col-1">
    <button class="w-100 h-100" (click)="removeFromList(fields, field)">
      <mat-icon>cancel</mat-icon>
    </button>
  </div>
</div>

<div class="row">
  <button (click)="testTemplate(template)" style="width: 100%; height: 60px;">
    Test
  </button>
</div>

<div class="row">
  <div class="col" *ngFor="let state of template['__test_info'] | keyvalue: sortNull"
    [ngStyle]="{'background': state.value.ok ? 'green' : 'red' }">
    {{state.key}}
  </div>
</div>

<div class="row">
  <div class="col">
    {{problems}}
  </div>
</div>